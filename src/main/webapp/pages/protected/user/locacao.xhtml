<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:jsn="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:p="http://primefaces.org/ui"
    template="/pages/layout/layout.xhtml">

	<ui:define name="restrict">
		<jsn:titulo label="Locação" />
		
		<h:form id="formContent">
			<fieldset jsf:id="fieldsetGerenciamento" class="fieldset">
				<h:panelGrid columns="2" width="100%" cellspacing="5"
					columnClasses="coluna-50, coluna-50">
					
					<h:panelGrid width="100%" columns="1">
						<h:outputText value="Cliente" />
						<p:selectOneMenu value="#{locacaoBean.clienteSelecionado}" var="objeto" style="width: 99%;"
							converter="genericConverter" filter="true" filterMatchMode="contains">
							<f:selectItem itemLabel="Selecione" itemValue=""/>
							<f:selectItems value="#{locacaoBean.listaCliente}" var="cliente"
									itemLabel=" #{cliente.cpf} | #{cliente.nome}" itemValue="#{cliente}" />
									
								<p:ajax event="change" update=":formContent"/>
								
								<p:column filterMatchMode="contains" filterBy="#{cliente.pessoa.cpf}">
									<h:outputText value="#{objeto.cpf}" />
								</p:column>
								
								<p:column filterMatchMode="contains" filterBy="#{cliente.nome}">
									<h:outputText value="#{objeto.nome}" />
								</p:column>
						</p:selectOneMenu>
					</h:panelGrid>

					<h:panelGrid width="100%">
						<h:outputText value="Veiculo" />
						<p:selectOneMenu value="#{locacaoBean.veiculoSelecionado}" var="objeto" style="width: 99%;"
							converter="genericConverter" filter="true" filterMatchMode="contains">
							<f:selectItem itemLabel="Selecione" itemValue=""/>
							<f:selectItems value="#{locacaoBean.listaVeiculo}" var="veiculo"
									itemLabel=" #{veiculo.placa} | #{veiculo.modelo}" itemValue="#{veiculo}" />
									
								<p:ajax event="change" update=":formContent"/>
								
								<p:column filterMatchMode="contains" filterBy="#{veiculo.placa}">
									<h:outputText value="#{objeto.placa}" />
								</p:column>
								
								<p:column filterMatchMode="contains" filterBy="#{veiculo.modelo}">
									<h:outputText value="#{objeto.modelo}" />
								</p:column>
						</p:selectOneMenu>
					</h:panelGrid>
				</h:panelGrid>
				
				<h:panelGrid columns="4" width="100%" cellspacing="5"
					columnClasses="coluna-15, coluna-15, coluna-20, coluna-50">
					
					<h:panelGrid width="100%">
						<h:outputText value="Data de retirada" />
						<p:calendar
							value="#{locacaoBean.objetoSelecionado.dataHoraLocacao}"
							navigator="true" mindate="#{locacaoBean.dataAtual}"
							pattern="dd/MM/yyyy hh:mm" size="15" effect="explode"
							style="white-space: nowrap;" readonlyInput="true"
							showOn="button" />
					</h:panelGrid>
					
					<h:panelGrid width="100%">
						<h:outputText value="Data de devolução" />
						<p:calendar
							value="#{locacaoBean.objetoSelecionado.dataHoraPrevistaDevolucao}"
							navigator="true" mindate="#{locacaoBean.dataAtual}"
							pattern="dd/MM/yyyy hh:mm" size="15" effect="explode"
							style="white-space: nowrap;" readonlyInput="true"
							showOn="button" />
					</h:panelGrid>
					
					<h:panelGrid width="100%">
						<h:outputText value="Tipo Tarifa" />
						<p:selectOneMenu style="width: 100%;" converter="genericConverter"
							value="#{locacaoBean.objetoSelecionado.tipoTarifa}">
							<f:selectItem itemValue="1"
								itemLabel="Controlada" />
							<f:selectItem itemValue="2"
								itemLabel="Livre" />
						</p:selectOneMenu>
					</h:panelGrid>
					
					<h:panelGrid width="100%">
						<h:outputText value="Agência devolução" />
						<p:selectOneMenu value="#{locacaoBean.agenciaDevolucao}" var="objeto" style="width: 99%;"
								converter="genericConverter" filter="true" filterMatchMode="contains">
								<f:selectItem itemLabel="Selecione" itemValue=""/>
								<f:selectItems value="#{locacaoBean.listaAgencia}" var="agencia"
										itemLabel=" #{agencia.cnpj} | #{agencia.razaoSocial}" itemValue="#{agencia}" />
										
									<p:ajax event="change" update=":formContent"/>
									
									<p:column filterMatchMode="contains" filterBy="#{agencia.cnpj}">
										<h:outputText value="#{objeto.cnpj}" />
									</p:column>
									
									<p:column filterMatchMode="contains" filterBy="#{agencia.razaoSocial}">
										<h:outputText value="#{objeto.razaoSocial}" />
									</p:column>
							</p:selectOneMenu>
					</h:panelGrid>
				</h:panelGrid>
				
				<div class="panel-button-crud">
					<p:commandButton value="Efetuar Pagamento" onclick="PF('modalPagamento').show();" 
						styleClass="button"/>			
				</div>
			</fieldset>
			
			<p:dialog id="modalPagamento" widgetVar="modalPagamento" closable="none" width="60%" 
				header="Pagamento" resizable="false">
				
				<h:panelGrid width="100%" columns="1" cellspacing="">
					<h:panelGrid width="100%">
						<h:outputText value="Titular do catão" />
						<p:inputText value="#{locacaoBean.pagamentoSelecionado.nomeTitular}" styleClass="input" />
					</h:panelGrid>
					<h:panelGrid width="100%">
						<h:outputText value="CPF" />
						<p:inputText value="#{locacaoBean.pagamentoSelecionado.cpf}" styleClass="input" />
					</h:panelGrid>
					<h:panelGrid width="100%">
						<h:outputText value="Número cartão" />
						<p:inputText value="#{locacaoBean.pagamentoSelecionado.cpf}" styleClass="input" />
					</h:panelGrid>
					
					<h:panelGrid width="100%" columns="2" columnClasses="coluna-30, coluna-70">
						<h:panelGrid width="100%">
							<h:outputText value="Código segurança" />
							<p:inputMask mask="999" styleClass="input-96"  />
						</h:panelGrid>
						
						<h:panelGrid width="100%">
							<h:outputText value="Data de devolução" />
							<p:calendar
								navigator="true" mindate="#{locacaoBean.dataAtual}"
								pattern="dd/MM/yyyy hh:mm" size="15" effect="explode"
								style="white-space: nowrap;" readonlyInput="true"
								showOn="button" />
						</h:panelGrid>
					</h:panelGrid>
				</h:panelGrid>
				
				<div class="panel-button-crud">
					<p:commandButton value="Finalizar" actionListener="#{locacaoBean.cadastrar()}" 
						styleClass="button"/>
					
					<p:commandButton value="Cancelar" onclick="PF('modalPagamento').hide();" 
						styleClass="button"/>		
				</div>
			</p:dialog>
		</h:form>
	</ui:define>
</ui:composition>
